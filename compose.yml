services:
  qwen3-tts:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: qwen3-tts-server

    ports:
      - "8000:8000"

    environment:
      # Optional overrides
      HOST: "0.0.0.0"
      PORT: "8000"
      WORKERS: "1"
      # HF_TOKEN: "${HF_TOKEN}"  # if needed for private repos

    volumes:
      - ./models:/app/models

    healthcheck:
      test: ["CMD-SHELL", "curl --fail http://localhost:8000/health || exit 1"]
      interval: 60s
      retries: 5
      start_period: 20s
      timeout: 10s

    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities: [gpu]